/home/pmonteag/work/brevitas/src/brevitas_examples/llm/llm_args.py:455: UserWarning: Data loading can take a long time or, potentially, enter an infinite loop. Consider setting --args.fuse_sequences or decreasing the sequence length (seqlen)
  warn(
Token indices sequence length is longer than the specified maximum sequence length for this model (2567892 > 8192). Running this sequence through the model will result in indexing errors
  0%|          | 0/128 [00:00<?, ?it/s]100%|██████████| 128/128 [00:00<00:00, 1779.26it/s]
  0%|          | 0/148 [00:00<?, ?it/s]100%|██████████| 148/148 [00:00<00:00, 18427.74it/s]
Computing perplexity...:   0%|          | 0/148 [00:00<?, ?it/s]Computing perplexity...:   1%|          | 1/148 [00:00<00:47,  3.10it/s]Computing perplexity...:   2%|▏         | 3/148 [00:00<00:19,  7.62it/s]Computing perplexity...:   3%|▎         | 5/148 [00:00<00:16,  8.79it/s]Computing perplexity...:   5%|▍         | 7/148 [00:00<00:14,  9.84it/s]Computing perplexity...:   6%|▌         | 9/148 [00:00<00:13, 10.49it/s]Computing perplexity...:   7%|▋         | 11/148 [00:01<00:12, 10.89it/s]Computing perplexity...:   9%|▉         | 13/148 [00:01<00:12, 11.16it/s]Computing perplexity...:  10%|█         | 15/148 [00:01<00:11, 11.28it/s]Computing perplexity...:  11%|█▏        | 17/148 [00:01<00:11, 11.45it/s]Computing perplexity...:  13%|█▎        | 19/148 [00:01<00:11, 11.54it/s]Computing perplexity...:  14%|█▍        | 21/148 [00:02<00:10, 11.60it/s]Computing perplexity...:  16%|█▌        | 23/148 [00:02<00:10, 11.63it/s]Computing perplexity...:  17%|█▋        | 25/148 [00:02<00:10, 11.66it/s]Computing perplexity...:  18%|█▊        | 27/148 [00:02<00:10, 11.67it/s]Computing perplexity...:  20%|█▉        | 29/148 [00:02<00:10, 11.66it/s]Computing perplexity...:  21%|██        | 31/148 [00:02<00:10, 11.68it/s]Computing perplexity...:  22%|██▏       | 33/148 [00:03<00:09, 11.70it/s]Computing perplexity...:  24%|██▎       | 35/148 [00:03<00:09, 11.65it/s]Computing perplexity...:  25%|██▌       | 37/148 [00:03<00:09, 11.67it/s]Computing perplexity...:  26%|██▋       | 39/148 [00:03<00:09, 11.58it/s]Computing perplexity...:  28%|██▊       | 41/148 [00:03<00:09, 11.68it/s]Computing perplexity...:  29%|██▉       | 43/148 [00:03<00:08, 11.68it/s]Computing perplexity...:  30%|███       | 45/148 [00:04<00:08, 11.68it/s]Computing perplexity...:  32%|███▏      | 47/148 [00:04<00:08, 11.66it/s]Computing perplexity...:  33%|███▎      | 49/148 [00:04<00:08, 11.65it/s]Computing perplexity...:  34%|███▍      | 51/148 [00:04<00:08, 11.64it/s]Computing perplexity...:  36%|███▌      | 53/148 [00:04<00:08, 11.66it/s]Computing perplexity...:  37%|███▋      | 55/148 [00:04<00:07, 11.65it/s]Computing perplexity...:  39%|███▊      | 57/148 [00:05<00:07, 11.59it/s]Computing perplexity...:  40%|███▉      | 59/148 [00:05<00:07, 11.67it/s]Computing perplexity...:  41%|████      | 61/148 [00:05<00:07, 11.66it/s]Computing perplexity...:  43%|████▎     | 63/148 [00:05<00:07, 11.63it/s]Computing perplexity...:  44%|████▍     | 65/148 [00:05<00:07, 11.65it/s]Computing perplexity...:  45%|████▌     | 67/148 [00:05<00:06, 11.58it/s]Computing perplexity...:  47%|████▋     | 69/148 [00:06<00:06, 11.66it/s]Computing perplexity...:  48%|████▊     | 71/148 [00:06<00:06, 11.64it/s]Computing perplexity...:  49%|████▉     | 73/148 [00:06<00:06, 11.66it/s]Computing perplexity...:  51%|█████     | 75/148 [00:06<00:06, 11.63it/s]Computing perplexity...:  52%|█████▏    | 77/148 [00:06<00:06, 11.62it/s]Computing perplexity...:  53%|█████▎    | 79/148 [00:06<00:05, 11.64it/s]Computing perplexity...:  55%|█████▍    | 81/148 [00:07<00:05, 11.63it/s]Computing perplexity...:  56%|█████▌    | 83/148 [00:07<00:05, 11.64it/s]Computing perplexity...:  57%|█████▋    | 85/148 [00:07<00:05, 11.63it/s]Computing perplexity...:  59%|█████▉    | 87/148 [00:07<00:05, 11.63it/s]Computing perplexity...:  60%|██████    | 89/148 [00:07<00:05, 11.60it/s]Computing perplexity...:  61%|██████▏   | 91/148 [00:08<00:04, 11.57it/s]Computing perplexity...:  63%|██████▎   | 93/148 [00:08<00:04, 11.58it/s]Computing perplexity...:  64%|██████▍   | 95/148 [00:08<00:04, 11.61it/s]Computing perplexity...:  66%|██████▌   | 97/148 [00:08<00:04, 11.58it/s]Computing perplexity...:  67%|██████▋   | 99/148 [00:08<00:04, 11.60it/s]Computing perplexity...:  68%|██████▊   | 101/148 [00:08<00:04, 11.61it/s]Computing perplexity...:  70%|██████▉   | 103/148 [00:09<00:03, 11.57it/s]Computing perplexity...:  71%|███████   | 105/148 [00:09<00:03, 11.54it/s]Computing perplexity...:  72%|███████▏  | 107/148 [00:09<00:03, 11.55it/s]Computing perplexity...:  74%|███████▎  | 109/148 [00:09<00:03, 11.57it/s]Computing perplexity...:  75%|███████▌  | 111/148 [00:09<00:03, 11.56it/s]Computing perplexity...:  76%|███████▋  | 113/148 [00:09<00:03, 11.51it/s]Computing perplexity...:  78%|███████▊  | 115/148 [00:10<00:02, 11.50it/s]Computing perplexity...:  79%|███████▉  | 117/148 [00:10<00:02, 11.58it/s]Computing perplexity...:  80%|████████  | 119/148 [00:10<00:02, 11.55it/s]Computing perplexity...:  82%|████████▏ | 121/148 [00:10<00:02, 11.54it/s]Computing perplexity...:  83%|████████▎ | 123/148 [00:10<00:02, 11.57it/s]Computing perplexity...:  84%|████████▍ | 125/148 [00:10<00:01, 11.56it/s]Computing perplexity...:  86%|████████▌ | 127/148 [00:11<00:01, 11.51it/s]Computing perplexity...:  87%|████████▋ | 129/148 [00:11<00:01, 11.51it/s]Computing perplexity...:  89%|████████▊ | 131/148 [00:11<00:01, 11.52it/s]Computing perplexity...:  90%|████████▉ | 133/148 [00:11<00:01, 11.51it/s]Computing perplexity...:  91%|█████████ | 135/148 [00:11<00:01, 11.53it/s]Computing perplexity...:  93%|█████████▎| 137/148 [00:12<00:00, 11.53it/s]Computing perplexity...:  94%|█████████▍| 139/148 [00:12<00:00, 11.55it/s]Computing perplexity...:  95%|█████████▌| 141/148 [00:12<00:00, 11.54it/s]Computing perplexity...:  97%|█████████▋| 143/148 [00:12<00:00, 11.09it/s]Computing perplexity...:  98%|█████████▊| 145/148 [00:12<00:00, 11.64it/s]Computing perplexity...:  99%|█████████▉| 147/148 [00:12<00:00, 11.62it/s]Computing perplexity...: 100%|██████████| 148/148 [00:12<00:00, 11.42it/s]
The model weights are not tied. Please use the `tie_weights` method before using the `infer_auto_device` function.
/home/pmonteag/.local/miniforge3/envs/brevitas_env/lib/python3.12/site-packages/torch/_tensor.py:1413: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at ../c10/core/TensorImpl.h:1925.)
  return super().rename(names)
Computing perplexity...:   0%|          | 0/148 [00:00<?, ?it/s]Computing perplexity...:   1%|▏         | 2/148 [00:00<00:13, 10.83it/s]Computing perplexity...:   3%|▎         | 4/148 [00:00<00:14, 10.03it/s]Computing perplexity...:   4%|▍         | 6/148 [00:00<00:14, 10.01it/s]Computing perplexity...:   5%|▌         | 8/148 [00:00<00:14,  9.86it/s]Computing perplexity...:   7%|▋         | 10/148 [00:00<00:13,  9.97it/s]Computing perplexity...:   7%|▋         | 11/148 [00:01<00:13,  9.95it/s]Computing perplexity...:   8%|▊         | 12/148 [00:01<00:13,  9.95it/s]Computing perplexity...:   9%|▉         | 13/148 [00:01<00:13,  9.90it/s]Computing perplexity...:   9%|▉         | 14/148 [00:01<00:13,  9.92it/s]Computing perplexity...:  10%|█         | 15/148 [00:01<00:13,  9.86it/s]Computing perplexity...:  11%|█         | 16/148 [00:01<00:13,  9.88it/s]Computing perplexity...:  12%|█▏        | 18/148 [00:01<00:13,  9.89it/s]Computing perplexity...:  13%|█▎        | 19/148 [00:01<00:13,  9.89it/s]Computing perplexity...:  14%|█▎        | 20/148 [00:02<00:12,  9.89it/s]Computing perplexity...:  14%|█▍        | 21/148 [00:02<00:12,  9.91it/s]Computing perplexity...:  15%|█▍        | 22/148 [00:02<00:12,  9.90it/s]Computing perplexity...:  16%|█▌        | 23/148 [00:02<00:12,  9.79it/s]Computing perplexity...:  17%|█▋        | 25/148 [00:02<00:12,  9.90it/s]Computing perplexity...:  18%|█▊        | 26/148 [00:02<00:12,  9.88it/s]Computing perplexity...:  18%|█▊        | 27/148 [00:02<00:12,  9.87it/s]Computing perplexity...:  19%|█▉        | 28/148 [00:02<00:12,  9.85it/s]Computing perplexity...:  20%|█▉        | 29/148 [00:02<00:12,  9.87it/s]Computing perplexity...:  20%|██        | 30/148 [00:03<00:12,  9.80it/s]Computing perplexity...:  22%|██▏       | 32/148 [00:03<00:11,  9.89it/s]Computing perplexity...:  22%|██▏       | 33/148 [00:03<00:11,  9.87it/s]Computing perplexity...:  23%|██▎       | 34/148 [00:03<00:11,  9.87it/s]Computing perplexity...:  24%|██▎       | 35/148 [00:03<00:11,  9.86it/s]Computing perplexity...:  24%|██▍       | 36/148 [00:03<00:11,  9.88it/s]Computing perplexity...:  25%|██▌       | 37/148 [00:03<00:11,  9.87it/s]Computing perplexity...:  26%|██▌       | 38/148 [00:03<00:11,  9.75it/s]Computing perplexity...:  27%|██▋       | 40/148 [00:04<00:10,  9.87it/s]Computing perplexity...:  28%|██▊       | 41/148 [00:04<00:10,  9.88it/s]Computing perplexity...:  28%|██▊       | 42/148 [00:04<00:10,  9.87it/s]Computing perplexity...:  29%|██▉       | 43/148 [00:04<00:10,  9.87it/s]Computing perplexity...:  30%|██▉       | 44/148 [00:04<00:10,  9.82it/s]Computing perplexity...:  31%|███       | 46/148 [00:04<00:10,  9.70it/s]Computing perplexity...:  32%|███▏      | 48/148 [00:04<00:10,  9.86it/s]Computing perplexity...:  33%|███▎      | 49/148 [00:04<00:10,  9.86it/s]Computing perplexity...:  34%|███▍      | 50/148 [00:05<00:09,  9.86it/s]Computing perplexity...:  34%|███▍      | 51/148 [00:05<00:09,  9.85it/s]Computing perplexity...:  35%|███▌      | 52/148 [00:05<00:09,  9.81it/s]Computing perplexity...:  36%|███▌      | 53/148 [00:05<00:09,  9.77it/s]Computing perplexity...:  37%|███▋      | 55/148 [00:05<00:09,  9.86it/s]Computing perplexity...:  38%|███▊      | 56/148 [00:05<00:09,  9.85it/s]Computing perplexity...:  39%|███▊      | 57/148 [00:05<00:09,  9.82it/s]Computing perplexity...:  39%|███▉      | 58/148 [00:05<00:09,  9.83it/s]Computing perplexity...:  40%|███▉      | 59/148 [00:05<00:09,  9.78it/s]Computing perplexity...:  41%|████      | 61/148 [00:06<00:08,  9.85it/s]Computing perplexity...:  42%|████▏     | 62/148 [00:06<00:08,  9.84it/s]Computing perplexity...:  43%|████▎     | 63/148 [00:06<00:08,  9.87it/s]Computing perplexity...:  43%|████▎     | 64/148 [00:06<00:08,  9.85it/s]Computing perplexity...:  44%|████▍     | 65/148 [00:06<00:08,  9.87it/s]Computing perplexity...:  45%|████▍     | 66/148 [00:06<00:08,  9.87it/s]Computing perplexity...:  45%|████▌     | 67/148 [00:06<00:08,  9.81it/s]Computing perplexity...:  46%|████▌     | 68/148 [00:06<00:08,  9.84it/s]Computing perplexity...:  47%|████▋     | 69/148 [00:06<00:08,  9.83it/s]Computing perplexity...:  47%|████▋     | 70/148 [00:07<00:07,  9.83it/s]Computing perplexity...:  48%|████▊     | 71/148 [00:07<00:07,  9.83it/s]Computing perplexity...:  49%|████▊     | 72/148 [00:07<00:07,  9.79it/s]Computing perplexity...:  49%|████▉     | 73/148 [00:07<00:07,  9.81it/s]Computing perplexity...:  50%|█████     | 74/148 [00:07<00:07,  9.81it/s]Computing perplexity...:  51%|█████     | 75/148 [00:07<00:07,  9.82it/s]Computing perplexity...:  51%|█████▏    | 76/148 [00:07<00:07,  9.81it/s]Computing perplexity...:  52%|█████▏    | 77/148 [00:07<00:07,  9.78it/s]Computing perplexity...:  53%|█████▎    | 78/148 [00:07<00:07,  9.82it/s]Computing perplexity...:  53%|█████▎    | 79/148 [00:08<00:07,  9.79it/s]Computing perplexity...:  54%|█████▍    | 80/148 [00:08<00:06,  9.80it/s]Computing perplexity...:  55%|█████▍    | 81/148 [00:08<00:06,  9.82it/s]Computing perplexity...:  55%|█████▌    | 82/148 [00:08<00:06,  9.78it/s]Computing perplexity...:  56%|█████▌    | 83/148 [00:08<00:06,  9.77it/s]Computing perplexity...:  57%|█████▋    | 84/148 [00:08<00:06,  9.81it/s]Computing perplexity...:  57%|█████▋    | 85/148 [00:08<00:06,  9.80it/s]Computing perplexity...:  58%|█████▊    | 86/148 [00:08<00:06,  9.79it/s]Computing perplexity...:  59%|█████▉    | 87/148 [00:08<00:06,  9.77it/s]Computing perplexity...:  59%|█████▉    | 88/148 [00:08<00:06,  9.79it/s]Computing perplexity...:  60%|██████    | 89/148 [00:09<00:06,  9.81it/s]Computing perplexity...:  61%|██████    | 90/148 [00:09<00:05,  9.81it/s]Computing perplexity...:  61%|██████▏   | 91/148 [00:09<00:05,  9.82it/s]Computing perplexity...:  62%|██████▏   | 92/148 [00:09<00:05,  9.81it/s]Computing perplexity...:  63%|██████▎   | 93/148 [00:09<00:05,  9.81it/s]Computing perplexity...:  64%|██████▎   | 94/148 [00:09<00:05,  9.83it/s]Computing perplexity...:  64%|██████▍   | 95/148 [00:09<00:05,  9.83it/s]Computing perplexity...:  65%|██████▍   | 96/148 [00:09<00:05,  9.83it/s]Computing perplexity...:  66%|██████▌   | 97/148 [00:09<00:05,  9.80it/s]Computing perplexity...:  66%|██████▌   | 98/148 [00:09<00:05,  9.80it/s]Computing perplexity...:  67%|██████▋   | 99/148 [00:10<00:05,  9.79it/s]Computing perplexity...:  68%|██████▊   | 100/148 [00:10<00:04,  9.79it/s]Computing perplexity...:  68%|██████▊   | 101/148 [00:10<00:04,  9.75it/s]Computing perplexity...:  69%|██████▉   | 102/148 [00:10<00:04,  9.78it/s]Computing perplexity...:  70%|██████▉   | 103/148 [00:10<00:04,  9.79it/s]Computing perplexity...:  70%|███████   | 104/148 [00:10<00:04,  9.79it/s]Computing perplexity...:  71%|███████   | 105/148 [00:10<00:04,  9.78it/s]Computing perplexity...:  72%|███████▏  | 106/148 [00:10<00:04,  9.73it/s]Computing perplexity...:  72%|███████▏  | 107/148 [00:10<00:04,  9.76it/s]Computing perplexity...:  73%|███████▎  | 108/148 [00:10<00:04,  9.78it/s]Computing perplexity...:  74%|███████▎  | 109/148 [00:11<00:04,  9.73it/s]Computing perplexity...:  74%|███████▍  | 110/148 [00:11<00:03,  9.78it/s]Computing perplexity...:  75%|███████▌  | 111/148 [00:11<00:03,  9.75it/s]Computing perplexity...:  76%|███████▌  | 112/148 [00:11<00:03,  9.69it/s]Computing perplexity...:  76%|███████▋  | 113/148 [00:11<00:03,  9.76it/s]Computing perplexity...:  77%|███████▋  | 114/148 [00:11<00:03,  9.82it/s]Computing perplexity...:  78%|███████▊  | 115/148 [00:11<00:03,  9.81it/s]Computing perplexity...:  78%|███████▊  | 116/148 [00:11<00:03,  9.75it/s]Computing perplexity...:  79%|███████▉  | 117/148 [00:11<00:03,  9.78it/s]Computing perplexity...:  80%|███████▉  | 118/148 [00:11<00:03,  9.78it/s]Computing perplexity...:  80%|████████  | 119/148 [00:12<00:02,  9.78it/s]Computing perplexity...:  81%|████████  | 120/148 [00:12<00:02,  9.78it/s]Computing perplexity...:  82%|████████▏ | 121/148 [00:12<00:02,  9.73it/s]Computing perplexity...:  82%|████████▏ | 122/148 [00:12<00:02,  9.78it/s]Computing perplexity...:  83%|████████▎ | 123/148 [00:12<00:02,  9.79it/s]Computing perplexity...:  84%|████████▍ | 124/148 [00:12<00:02,  9.78it/s]Computing perplexity...:  84%|████████▍ | 125/148 [00:12<00:02,  9.74it/s]Computing perplexity...:  85%|████████▌ | 126/148 [00:12<00:02,  9.73it/s]Computing perplexity...:  86%|████████▌ | 127/148 [00:12<00:02,  9.64it/s]Computing perplexity...:  87%|████████▋ | 129/148 [00:13<00:01,  9.79it/s]Computing perplexity...:  88%|████████▊ | 130/148 [00:13<00:01,  9.80it/s]Computing perplexity...:  89%|████████▊ | 131/148 [00:13<00:01,  9.78it/s]Computing perplexity...:  89%|████████▉ | 132/148 [00:13<00:01,  9.80it/s]Computing perplexity...:  90%|████████▉ | 133/148 [00:13<00:01,  9.79it/s]Computing perplexity...:  91%|█████████ | 134/148 [00:13<00:01,  9.76it/s]Computing perplexity...:  91%|█████████ | 135/148 [00:13<00:01,  9.76it/s]Computing perplexity...:  92%|█████████▏| 136/148 [00:13<00:01,  9.72it/s]Computing perplexity...:  93%|█████████▎| 137/148 [00:13<00:01,  9.74it/s]Computing perplexity...:  93%|█████████▎| 138/148 [00:14<00:01,  9.72it/s]Computing perplexity...:  94%|█████████▍| 139/148 [00:14<00:00,  9.73it/s]Computing perplexity...:  95%|█████████▍| 140/148 [00:14<00:00,  9.69it/s]Computing perplexity...:  95%|█████████▌| 141/148 [00:14<00:00,  9.72it/s]Computing perplexity...:  96%|█████████▌| 142/148 [00:14<00:00,  9.65it/s]Computing perplexity...:  97%|█████████▋| 143/148 [00:14<00:00,  9.75it/s]Computing perplexity...:  97%|█████████▋| 144/148 [00:14<00:00,  9.74it/s]Computing perplexity...:  98%|█████████▊| 145/148 [00:14<00:00,  9.72it/s]Computing perplexity...:  99%|█████████▊| 146/148 [00:14<00:00,  9.74it/s]Computing perplexity...:  99%|█████████▉| 147/148 [00:14<00:00,  9.73it/s]Computing perplexity...: 100%|██████████| 148/148 [00:15<00:00,  9.75it/s]Computing perplexity...: 100%|██████████| 148/148 [00:15<00:00,  9.82it/s]
