/home/pmonteag/work/brevitas/src/brevitas_examples/llm/llm_args.py:455: UserWarning: Data loading can take a long time or, potentially, enter an infinite loop. Consider setting --args.fuse_sequences or decreasing the sequence length (seqlen)  warn(Token indices sequence length is longer than the specified maximum sequence length for this model (2567892 > 8192). Running this sequence through the model will result in indexing errors  0%|          | 0/128 [00:00<?, ?it/s]100%|██████████| 128/128 [00:00<00:00, 1764.58it/s]  0%|          | 0/148 [00:00<?, ?it/s]100%|██████████| 148/148 [00:00<00:00, 27644.49it/s]  0%|          | 0/800 [00:00<?, ?it/s] 18%|█▊        | 142/800 [00:00<00:00, 1417.30it/s]100%|██████████| 800/800 [00:00<00:00, 6185.33it/s]Computing perplexity...:   0%|          | 0/148 [00:00<?, ?it/s]Computing perplexity...:   1%|          | 1/148 [00:00<00:36,  3.98it/s]Computing perplexity...:   2%|▏         | 3/148 [00:00<00:16,  9.05it/s]Computing perplexity...:   3%|▎         | 5/148 [00:00<00:13, 10.39it/s]Computing perplexity...:   5%|▍         | 7/148 [00:00<00:12, 10.98it/s]Computing perplexity...:   6%|▌         | 9/148 [00:00<00:12, 11.30it/s]Computing perplexity...:   7%|▋         | 11/148 [00:01<00:11, 11.47it/s]Computing perplexity...:   9%|▉         | 13/148 [00:01<00:11, 11.66it/s]Computing perplexity...:  10%|█         | 15/148 [00:01<00:11, 11.73it/s]Computing perplexity...:  11%|█▏        | 17/148 [00:01<00:11, 11.77it/s]Computing perplexity...:  13%|█▎        | 19/148 [00:01<00:10, 11.81it/s]Computing perplexity...:  14%|█▍        | 21/148 [00:01<00:10, 11.84it/s]Computing perplexity...:  16%|█▌        | 23/148 [00:02<00:10, 11.89it/s]Computing perplexity...:  17%|█▋        | 25/148 [00:02<00:10, 11.88it/s]Computing perplexity...:  18%|█▊        | 27/148 [00:02<00:10, 11.86it/s]Computing perplexity...:  20%|█▉        | 29/148 [00:02<00:10, 11.89it/s]Computing perplexity...:  21%|██        | 31/148 [00:02<00:09, 11.91it/s]Computing perplexity...:  22%|██▏       | 33/148 [00:02<00:09, 11.90it/s]Computing perplexity...:  24%|██▎       | 35/148 [00:03<00:09, 11.84it/s]Computing perplexity...:  25%|██▌       | 37/148 [00:03<00:09, 11.90it/s]Computing perplexity...:  26%|██▋       | 39/148 [00:03<00:09, 11.87it/s]Computing perplexity...:  28%|██▊       | 41/148 [00:03<00:09, 11.85it/s]Computing perplexity...:  29%|██▉       | 43/148 [00:03<00:08, 11.84it/s]Computing perplexity...:  30%|███       | 45/148 [00:03<00:08, 11.87it/s]Computing perplexity...:  32%|███▏      | 47/148 [00:04<00:08, 11.89it/s]Computing perplexity...:  33%|███▎      | 49/148 [00:04<00:08, 11.86it/s]Computing perplexity...:  34%|███▍      | 51/148 [00:04<00:08, 11.85it/s]Computing perplexity...:  36%|███▌      | 53/148 [00:04<00:08, 11.87it/s]Computing perplexity...:  37%|███▋      | 55/148 [00:04<00:07, 11.87it/s]Computing perplexity...:  39%|███▊      | 57/148 [00:04<00:07, 11.83it/s]Computing perplexity...:  40%|███▉      | 59/148 [00:05<00:07, 11.86it/s]Computing perplexity...:  41%|████      | 61/148 [00:05<00:07, 11.87it/s]Computing perplexity...:  43%|████▎     | 63/148 [00:05<00:07, 11.86it/s]Computing perplexity...:  44%|████▍     | 65/148 [00:05<00:07, 11.81it/s]Computing perplexity...:  45%|████▌     | 67/148 [00:05<00:06, 11.85it/s]Computing perplexity...:  47%|████▋     | 69/148 [00:05<00:06, 11.81it/s]Computing perplexity...:  48%|████▊     | 71/148 [00:06<00:06, 11.88it/s]Computing perplexity...:  49%|████▉     | 73/148 [00:06<00:06, 11.82it/s]Computing perplexity...:  51%|█████     | 75/148 [00:06<00:06, 11.86it/s]Computing perplexity...:  52%|█████▏    | 77/148 [00:06<00:05, 11.87it/s]Computing perplexity...:  53%|█████▎    | 79/148 [00:06<00:05, 11.87it/s]Computing perplexity...:  55%|█████▍    | 81/148 [00:06<00:05, 11.83it/s]Computing perplexity...:  56%|█████▌    | 83/148 [00:07<00:05, 11.85it/s]Computing perplexity...:  57%|█████▋    | 85/148 [00:07<00:05, 11.86it/s]Computing perplexity...:  59%|█████▉    | 87/148 [00:07<00:05, 11.82it/s]Computing perplexity...:  60%|██████    | 89/148 [00:07<00:05, 11.80it/s]Computing perplexity...:  61%|██████▏   | 91/148 [00:07<00:04, 11.74it/s]Computing perplexity...:  63%|██████▎   | 93/148 [00:07<00:04, 11.85it/s]Computing perplexity...:  64%|██████▍   | 95/148 [00:08<00:04, 11.84it/s]Computing perplexity...:  66%|██████▌   | 97/148 [00:08<00:04, 11.83it/s]Computing perplexity...:  67%|██████▋   | 99/148 [00:08<00:04, 11.84it/s]Computing perplexity...:  68%|██████▊   | 101/148 [00:08<00:03, 11.83it/s]Computing perplexity...:  70%|██████▉   | 103/148 [00:08<00:03, 11.81it/s]Computing perplexity...:  71%|███████   | 105/148 [00:08<00:03, 11.80it/s]Computing perplexity...:  72%|███████▏  | 107/148 [00:09<00:03, 11.83it/s]Computing perplexity...:  74%|███████▎  | 109/148 [00:09<00:03, 11.77it/s]Computing perplexity...:  75%|███████▌  | 111/148 [00:09<00:03, 11.80it/s]Computing perplexity...:  76%|███████▋  | 113/148 [00:09<00:02, 11.84it/s]Computing perplexity...:  78%|███████▊  | 115/148 [00:09<00:02, 11.82it/s]Computing perplexity...:  79%|███████▉  | 117/148 [00:09<00:02, 11.81it/s]Computing perplexity...:  80%|████████  | 119/148 [00:10<00:02, 11.77it/s]Computing perplexity...:  82%|████████▏ | 121/148 [00:10<00:02, 11.79it/s]Computing perplexity...:  83%|████████▎ | 123/148 [00:10<00:02, 11.81it/s]Computing perplexity...:  84%|████████▍ | 125/148 [00:10<00:01, 11.78it/s]Computing perplexity...:  86%|████████▌ | 127/148 [00:10<00:01, 11.78it/s]Computing perplexity...:  87%|████████▋ | 129/148 [00:11<00:01, 11.81it/s]Computing perplexity...:  89%|████████▊ | 131/148 [00:11<00:01, 11.81it/s]Computing perplexity...:  90%|████████▉ | 133/148 [00:11<00:01, 11.77it/s]Computing perplexity...:  91%|█████████ | 135/148 [00:11<00:01, 11.79it/s]Computing perplexity...:  93%|█████████▎| 137/148 [00:11<00:00, 11.76it/s]Computing perplexity...:  94%|█████████▍| 139/148 [00:11<00:00, 11.80it/s]Computing perplexity...:  95%|█████████▌| 141/148 [00:12<00:00, 11.76it/s]Computing perplexity...:  97%|█████████▋| 143/148 [00:12<00:00, 11.78it/s]Computing perplexity...:  98%|█████████▊| 145/148 [00:12<00:00, 11.77it/s]Computing perplexity...:  99%|█████████▉| 147/148 [00:12<00:00, 11.79it/s]Computing perplexity...: 100%|██████████| 148/148 [00:12<00:00, 11.72it/s]/home/pmonteag/work/brevitas/src/brevitas/graph/equalize.py:1750: UserWarning: Using parametrized results might break type-checking, which could lead to unexpected behaviour.  warnings.warn(/home/pmonteag/.local/miniforge3/envs/brevitas_env/lib/python3.12/site-packages/torch/_tensor.py:1413: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at ../c10/core/TensorImpl.h:1925.)  return super().rename(names)/home/pmonteag/work/brevitas/src/brevitas_examples/llm/llm_quant/rotation_optimization.py:107: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `DistilledTrainer.__init__`. Use `processing_class` instead.  super().__init__(args=args, **kwargs)Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<12:52,  7.80s/it]  2%|▏         | 2/100 [00:15<12:21,  7.57s/it]  3%|▎         | 3/100 [00:22<12:03,  7.46s/it]  4%|▍         | 4/100 [00:29<11:50,  7.40s/it]  5%|▌         | 5/100 [00:37<11:39,  7.37s/it]  6%|▌         | 6/100 [00:44<11:31,  7.35s/it]  7%|▋         | 7/100 [00:51<11:22,  7.34s/it]  8%|▊         | 8/100 [00:59<11:14,  7.33s/it]  9%|▉         | 9/100 [01:06<11:06,  7.32s/it] 10%|█         | 10/100 [01:13<10:59,  7.33s/it]                                                 10%|█         | 10/100 [01:13<10:59,  7.33s/it] 11%|█         | 11/100 [01:21<10:52,  7.33s/it] 12%|█▏        | 12/100 [01:28<10:45,  7.34s/it] 13%|█▎        | 13/100 [01:35<10:37,  7.33s/it] 14%|█▍        | 14/100 [01:43<10:30,  7.33s/it] 15%|█▌        | 15/100 [01:50<10:23,  7.33s/it] 16%|█▌        | 16/100 [01:57<10:16,  7.34s/it] 17%|█▋        | 17/100 [02:05<10:08,  7.34s/it] 18%|█▊        | 18/100 [02:12<10:01,  7.34s/it] 19%|█▉        | 19/100 [02:20<10:05,  7.48s/it] 20%|██        | 20/100 [02:27<09:55,  7.44s/it]                                                 20%|██        | 20/100 [02:27<09:55,  7.44s/it] 21%|██        | 21/100 [02:34<09:46,  7.42s/it] 22%|██▏       | 22/100 [02:42<09:37,  7.40s/it] 23%|██▎       | 23/100 [02:49<09:28,  7.39s/it] 24%|██▍       | 24/100 [02:57<09:21,  7.38s/it] 25%|██▌       | 25/100 [03:04<09:13,  7.38s/it] 26%|██▌       | 26/100 [03:11<09:05,  7.37s/it] 27%|██▋       | 27/100 [03:19<08:59,  7.39s/it] 28%|██▊       | 28/100 [03:26<08:53,  7.41s/it] 29%|██▉       | 29/100 [03:34<08:46,  7.42s/it] 30%|███       | 30/100 [03:41<08:39,  7.42s/it]                                                 30%|███       | 30/100 [03:41<08:39,  7.42s/it] 31%|███       | 31/100 [03:48<08:31,  7.41s/it] 32%|███▏      | 32/100 [03:56<08:24,  7.42s/it] 33%|███▎      | 33/100 [04:04<08:21,  7.49s/it] 34%|███▍      | 34/100 [04:11<08:14,  7.49s/it] 35%|███▌      | 35/100 [04:18<08:06,  7.48s/it] 36%|███▌      | 36/100 [04:26<07:59,  7.50s/it] 37%|███▋      | 37/100 [04:34<08:02,  7.66s/it] 38%|███▊      | 38/100 [04:42<07:54,  7.65s/it] 39%|███▉      | 39/100 [04:49<07:45,  7.63s/it] 40%|████      | 40/100 [04:57<07:36,  7.61s/it]                                                 40%|████      | 40/100 [04:57<07:36,  7.61s/it] 41%|████      | 41/100 [05:04<07:28,  7.61s/it] 42%|████▏     | 42/100 [05:12<07:20,  7.60s/it] 43%|████▎     | 43/100 [05:20<07:12,  7.58s/it] 44%|████▍     | 44/100 [05:27<07:03,  7.57s/it] 45%|████▌     | 45/100 [05:35<06:55,  7.56s/it] 46%|████▌     | 46/100 [05:42<06:48,  7.56s/it] 47%|████▋     | 47/100 [05:50<06:40,  7.55s/it] 48%|████▊     | 48/100 [05:57<06:32,  7.55s/it] 49%|████▉     | 49/100 [06:05<06:25,  7.56s/it] 50%|█████     | 50/100 [06:12<06:18,  7.57s/it]                                                 50%|█████     | 50/100 [06:12<06:18,  7.57s/it] 51%|█████     | 51/100 [06:20<06:10,  7.57s/it] 52%|█████▏    | 52/100 [06:28<06:02,  7.56s/it] 53%|█████▎    | 53/100 [06:35<05:55,  7.56s/it] 54%|█████▍    | 54/100 [06:43<05:48,  7.58s/it] 55%|█████▌    | 55/100 [06:50<05:41,  7.58s/it] 56%|█████▌    | 56/100 [06:58<05:38,  7.70s/it] 57%|█████▋    | 57/100 [07:06<05:29,  7.66s/it] 58%|█████▊    | 58/100 [07:13<05:21,  7.64s/it] 59%|█████▉    | 59/100 [07:21<05:12,  7.62s/it] 60%|██████    | 60/100 [07:29<05:04,  7.61s/it]                                                 60%|██████    | 60/100 [07:29<05:04,  7.61s/it] 61%|██████    | 61/100 [07:36<04:56,  7.60s/it] 62%|██████▏   | 62/100 [07:44<04:48,  7.60s/it] 63%|██████▎   | 63/100 [07:51<04:41,  7.60s/it] 64%|██████▍   | 64/100 [07:59<04:33,  7.60s/it] 65%|██████▌   | 65/100 [08:07<04:25,  7.59s/it] 66%|██████▌   | 66/100 [08:14<04:17,  7.58s/it] 67%|██████▋   | 67/100 [08:22<04:09,  7.56s/it] 68%|██████▊   | 68/100 [08:29<04:01,  7.55s/it] 69%|██████▉   | 69/100 [08:37<03:53,  7.54s/it] 70%|███████   | 70/100 [08:44<03:46,  7.54s/it]                                                 70%|███████   | 70/100 [08:44<03:46,  7.54s/it] 71%|███████   | 71/100 [08:52<03:38,  7.55s/it] 72%|███████▏  | 72/100 [08:59<03:31,  7.55s/it] 73%|███████▎  | 73/100 [09:07<03:23,  7.55s/it] 74%|███████▍  | 74/100 [09:14<03:16,  7.54s/it] 75%|███████▌  | 75/100 [09:22<03:12,  7.69s/it] 76%|███████▌  | 76/100 [09:30<03:04,  7.71s/it] 77%|███████▋  | 77/100 [09:38<02:57,  7.70s/it]Process Process-2:Traceback (most recent call last):  File "/home/pmonteag/.local/miniforge3/envs/brevitas_env/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap    self.run()  File "/home/pmonteag/.local/miniforge3/envs/brevitas_env/lib/python3.12/multiprocessing/process.py", line 108, in run    self._target(*self._args, **self._kwargs)  File "/home/pmonteag/work/brevitas/src/brevitas_examples/common/benchmark/utils.py", line 164, in run_args_bucket_process    results, _ = main_entrypoint(args, extra_args)                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^  File "/home/pmonteag/work/brevitas/src/brevitas_examples/llm/benchmark/llm_benchmark.py", line 45, in entrypoint_main    return quantize_llm(args=args, extra_args=extra_args)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^  File "/home/pmonteag/work/brevitas/src/brevitas_examples/llm/main.py", line 435, in quantize_llm    apply_rotation_optimization(  File "/home/pmonteag/work/brevitas/src/brevitas_examples/llm/llm_quant/rotation_optimization.py", line 277, in apply_rotation_optimization    trainer.train()  File "/home/pmonteag/.local/miniforge3/envs/brevitas_env/lib/python3.12/site-packages/transformers/trainer.py", line 2241, in train    return inner_training_loop(           ^^^^^^^^^^^^^^^^^^^^  File "/home/pmonteag/.local/miniforge3/envs/brevitas_env/lib/python3.12/site-packages/transformers/trainer.py", line 2548, in _inner_training_loop    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^  File "/home/pmonteag/.local/miniforge3/envs/brevitas_env/lib/python3.12/site-packages/transformers/trainer.py", line 3740, in training_step    self.accelerator.backward(loss, **kwargs)  File "/home/pmonteag/.local/miniforge3/envs/brevitas_env/lib/python3.12/site-packages/accelerate/accelerator.py", line 2197, in backward    loss.backward(**kwargs)  File "/home/pmonteag/.local/miniforge3/envs/brevitas_env/lib/python3.12/site-packages/torch/_tensor.py", line 521, in backward    torch.autograd.backward(  File "/home/pmonteag/.local/miniforge3/envs/brevitas_env/lib/python3.12/site-packages/torch/autograd/__init__.py", line 289, in backward    _engine_run_backward(  File "/home/pmonteag/.local/miniforge3/envs/brevitas_env/lib/python3.12/site-packages/torch/autograd/graph.py", line 769, in _engine_run_backward    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^KeyboardInterrupt 77%|███████▋  | 77/100 [09:45<02:55,  7.61s/it]